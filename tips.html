<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Today's Tips</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <header>
    <nav>
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="bets_accumulator.html">Bets & Accumulator</a></li>
        <li><a href="tips.html">Today's Tips</a></li>
        <li><a href="results.html">Results</a></li>
        <li><a href="tipster_profiles.html">Tipster_Profiles</a></li>
      </ul>
    </nav>
  </header>

  <div class="page-banner" style="background-image: url('images/todays_tips-banner (1).jpg');">
    <h1>Top Metric Selections</h1>
  </div>

  <main>
    <p>Below are today's top selections generated using our AI models and smart scoring system:</p>

    <!-- ✅ Dynamic data from Google Apps Script appears here -->
    <div id="gdrive-data"></div>
  </main>

  <footer>
    <p>&copy; 2025 Horse Racing Tips</p>
  </footer>

  <script>
    fetch('https://script.google.com/macros/s/AKfycbxRHcIVAOp4oBNA1BgJsdCVE8cW5DbYOETpuU3e9sG38psRHHKGPoVrqh8ucl71TMYR/exec')
      .then(response => response.json())
      .then(data => {
        const headers = [
          "🔥 Confidence",
          "📍 Course",
          "⏰ Off Time",
          "🏇 Horse",
          "💰 Odds",
          "🏁 Result",
          "💵 Profit",
          "📊 Super Score",
          "📈 Weighted Score",
          "🎯 Rank"
        ];

        let output = '<table border="1"><tr>';
        headers.forEach(h => output += `<th>${h}</th>`);
        output += '</tr>';

        data.slice(1).forEach(row => {
          output += '<tr>';
          headers.forEach((h, i) => {
            let cell = row[i];

            if (i === 0) {
              const color =
                cell === "Strong" ? "#c8e6c9" :
                cell === "Medium" ? "#fff9c4" :
                "#ffe0b2";
              cell = `<span style="background-color:${color}; padding:4px; border-radius:4px;">${cell}</span>`;
            }

            output += `<td>${cell}</td>`;
          });
          output += '</tr>';
        });

        output += '</table>';
        document.getElementById('gdrive-data').innerHTML = output;
      })
      .catch(error => {
        document.getElementById('gdrive-data').textContent = 'Failed to load data: ' + error;
      });
  </script>

</body>
</html>
